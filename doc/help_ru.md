<style type="text/css" rel="stylesheet">
img[src*='#center'] {
    display: block;
    margin: auto;
}
.center {
    text-align: center;
}
table {
    width: 100%;
}
</style>

# Программа "Candle"

[1 Назначение программы](#1-назначение-программы)  
[2 Условия выполнения программы](#2-условия-выполнения-программы)  
[2.1 Требования к аппаратному обеспечению](#21-требования-к-аппаратному-обеспечению)  
[2.2 Требования к программному обеспечению](#22-требования-к-программному-обеспечению)  
[3 Выполнение программы](#3-выполнение-программы)  
[3.1 Установка программы](#31-установка-программы)  
[3.2 Запуск](#32-запуск)  
[3.3 Главное окно](#33-главное-окно)  
[3.3.1 Главное меню](#331-главное-меню)  
[3.3.2 Окна](#332-окна)  
[3.3.2.1 Окно "G-код программа"](#3321-окно-"g-код-программа")  
[3.3.2.2 Окно "Визуализатор"](#3322-окно-"визуализатор")  
[3.3.2.3 Окно "Камера"](#3323-окно-"камера")  
[3.3.2.4 Окно "Консоль"](#3324-окно-"консоль")  
[3.3.2.5 Окна "Устройство", "Модификация", "Пользователь"](#3325-окна-"устройство"-"модификация"-"пользователь")  
[3.3.3 Инструментальные панели](#333-инструментальные-панели)  
[3.3.3.1 Панель "Состояние"](#3331-панель-"состояние")  
[3.3.3.2 Панель "Управление"](#3332-панель-"управление")  
[3.3.3.3 Панель "Система координат"](#3333-панель-"система-координат")  
[3.3.3.4 Панель "Шпиндель"](#3334-панель-"шпиндель")  
[3.3.3.5 Панель "Перемещение"](#3335-панель-"перемещение")  
[3.3.3.6 Панель "Коррекция"](#3336-панель-"коррекция")  
[3.3.3.7 Панель "Карта высот"](#3337-панель-"карта-высот")  
[3.3.3.8 Панель "Пользовательские команды"](#3338-панель-"пользовательские-команды")  
[3.4 Окно настроек](#34-окно-настроек)  
[3.5 Подготовка программы к работе](#35-подготовка-программы-к-работе)  
[3.6 Загрузка управляющей программы](#36-загрузка-управляющей-программы)  
[3.7 Создание карты высот](#37-создание-карты-высот)  
[3.8 Выполнение управляющей программы](#38-выполнение-управляющей-программы)  
[3.9 Завершение работы с программой](#39-завершение-работы-с-программой)  
[4 Сообщения оператору](#4-сообщения-оператору)  
[5 Разработка расширений](#5-разработка-расширений)  
[5.1 Файл конфигурации расширения](#51-файл-конфигурации-расширения)  
[5.2 Файл скрипта](#52-файл-скрипта)  
[5.3 Файл перевода](#53-файл-перевода)  
[Приложение А. Настройки контроллера](#приложение-а-настройки-контроллера)  
[Приложение Б. Ошибки контроллера](#приложение-б-ошибки-контроллера)  
[Приложение В. Таблица G-код команд](#приложение-в-таблица-g-код-команд)

# 1 Назначение программы

Программа "Candle" (далее - программа) предназначена для управления станками с числовым программным управлением (далее - ЧПУ), имеющими контроллер "GRBL" (далее - контроллер), с помощью ПЭВМ.

Программа позволяет работать с фрезерными 3-ех осевыми станками, лазерными плоттерами.

Основные функции программы:

- Загрузка, редактирование, сохранение управляющих программ (далее - УП).
- Визуализация УП.
- Снятие карты неровности поверхности, коррекция УП в соответствии с заданной картой.
- Передача УП на ЧПУ.
- Отображение состояния ЧПУ.
- Ручное управление ЧПУ.

# 2 Условия выполнения программы

## 2.1 Требования к аппаратному обеспечению

Для корректной работы программы необходима ПЭВМ со следующими характеристиками:

- процессор, поддерживающий набор инструкций SSE2,
- графический адаптер, поддерживающий спецификацию OpenGL версии 2.0 и выше,
- дисплей с разрешением 1280х720,
- свободный порт USB или RS-232 для подключения ПЭВМ к контроллеру ЧПУ,
- свободное место на запоминающем устройстве не менее 20 Мб.

## 2.2 Требования к программному обеспечению

Программа требует наличия на ПЭВМ операционной системы Windows 7 и выше, с установленным драйвером OpenGL, драйвером преобразователя USB-UART при подключении ЧПУ через порт USB.

# 3 Выполнение программы

## 3.1 Установка программы

Программа поставляется в виде архива "candle_v.v.v_x86.zip" для 32-разрядных процессоров и "candle_v.v.v_x64.zip" для 64-разрядных, где v.v.v - номер версии программы.

Для установки необходимо распаковать архив в рабочую папку, например: "D:\". В папке будет создан каталог программы "Candle" со всеми необходимыми для работы файлами.

После распаковки, для обеспечения дальнейшего быстрого запуска, нужно создать ярлык к исполняемому файлу "D:\Candle\candle.exe".

## 3.2 Запуск

Запуск программы осуществляется по вызову файла "candle.exe" из папки установки или с помощью созданного ранее ярлыка.

## 3.3 Главное окно

При запуске программы на дисплее должно отобразиться главное окно программы, представленное на рисунке 1.

![Главное окно программы](images_ru/mainwindow.png#center)
<p class="center">Рисунок 1 - Главное окно программы</p>

Главное окно состоит из главного меню, расположенного сверху, набора окон и инструментальных панелей:

- "G-код программа" - основное окно, отображает список команд текущей УП.
- "Визуализатор" - графическое представление УП.
- "Камера" - изображение с камеры.
- "Консоль" - окно передачи команд в контроллер "GRBL" ЧПУ и отображения ответов.
- "Устройство" - окно с набором панелей для управления ЧПУ.
- "Модификация" - окно с набором панелей для коррекции УП.
- "Пользователь" - окно с набором пользовательских панелей.

Каждое окно имеет область заголовка и область содержимого. В заголовке расположено название окна, кнопки "Отделить", "Закрыть", в области содержимого - элементы ввода и отображения информации, а также инструментальные панели.

Все окна, за исключением окна "G-код программа", могут быть перемещены перетаскиванием с нажатой левой кнопки мыши (далее - ЛКМ) на заголовке окна. В процессе перемещения конфигурация главного окна программы будет динамически изменяться, указывая будущее расположение перемещаемого окна.

Окна могут быть отделены от главного окна нажатием на кнопку "Отделить" заголовка, закрыты - "Закрыть". Отделенные окна могут быть возвращены в главное окно перетаскиванием за заголовок, закрытые - выбором соответствующего пункта в главном меню "Вид - Окна".

Размеры окон изменяются нажатием ЛКМ на границу окна и ее перетаскиванием в нужную сторону.

### 3.3.1 Главное меню

Главное меню программы предоставляет доступ к основным функциям программы. Меню разделено на группы и пункты, описание которых приведено в таблице 1.

Таблица 1 - Главное меню программы

| Группа     | Пункт                | Описание                                 |
|------------|----------------------|------------------------------------------|
| Файл       | Новый                | Создание новой УП                        |
|            | Открыть              | Загрузка файла УП                        |
|            | Недавние файлы       | Загрузка одного из последних файлов УП   |
|            | Сохранить            | Запись изменений УП в файл               |
|            | Сохранить как        | Запись УП в указанный файл               |
|            | Выход                | Выход из программы                       |
| Вид        | Окна                 | Выбор отображаемых окон                  |
|            | Панели               | Выбор отображаемых панелей               |
|            | Зафиксировать окна   | Запрет/разрешение перемещения окон       |
|            | Зафиксировать панели | Запрет/разрешение перемещения панелей    |
| Сервис     | Настройки            | Вызов окна настроек программы            |
| Справка    | Документация         | Запуск справочной системы программы      |
|            | О программе          | Вызов окна с информацией о программе     |

### 3.3.2 Окна

#### 3.3.2.1 Окно "G-код программа"

Текущая УП отображается в окне "G-код программа", представленном на рисунке 2.

![Окно "G-код программа"](images_ru/g-codeprogram.png#center)
<p class="center">Рисунок 2 - Окно "G-код программа"</p>

Каждая строка УП соответствует строке в таблице, содержащей столбцы:

- "№" - номер строки УП.
- "Команда" - команда УП.
- "Состояние" - текущее состояние команды ("В очереди", "Отправлена", "Обработана", "Пропущена").
- "Ответ" - ответ контроллера на отправленную команду.

УП может быть отредактирована, поддерживаются следующие функции:

- Изменение команды в выбранной строке.
- Добавления новых строк УП.
- Удаление строк УП. 

Вход в режим редактирования команды УП выполняется двойным нажатием ЛКМ в столбце "Команда" выбранной строки или нажатием клавиши \<F2\> в предварительно выбранной ячейке. Подтверждение ввода измененной команды осуществляется нажатием клавиши \<Enter\> или \<Tab\>, отмена - нажатием клавиши \<Esc\>.

Для добавления строки - необходимо выбрать в таблице строку, перед которой вставляется новая строка, и активировать пункт "Вставить строку" контекстного меню, вызываемого нажатием правой кнопки мыши (далее - ПКМ) в области таблицы, или нажать на клавишу \<Ins\> клавиатуры.

Удаление выделенных строк таблицы производится вызовом пункта "Удалить строки" контекстного меню таблицы или нажатием на клавишу \<Del\> клавиатуры.

Под таблицей расположены кнопки управления загрузкой и отправкой УП в контроллер ЧПУ:

- "Открыть" - вызывает диалог выбора файла УП, в случае подтверждения выбора - загружает УП.
- "Сброс" - снимает выделение в таблице, устанавливает первую строку УП текущей, сбрасывает состояние команд.
- "Отправить" - запускает процесс передачи УП в контроллер ЧПУ.
- "Пауза" - приостанавливает процесс передачи УП.
- "Прервать" - останавливает передачу УП.

Следует учитывать, что при активации команд "Пауза" и "Остановить" фактическая остановка ЧПУ выполняется только по опустошению входного буфера команд контроллера. Для немедленной остановки ЧПУ необходимо использовать команды панели "Управление": "Удержание", "Сброс".

Слева от кнопок расположен флаг, отвечающий за автоматическую прокрутку таблицы в процессе отправки УП. При активной передаче УП в контроллер и ручной прокрутке таблицы флаг сбрасывается.

#### 3.3.2.2 Окно "Визуализатор"

Графическое представление УП отображается в окне "Визуализатор" (рисунок 3).

![Окно "Визуализатор"](images_ru/visualizer.png#center)
<p class="center">Рисунок 3 - Окно "Визуализатор"</p>

В окне можно выделить пять функциональных областей:

- Центральная или основная область, в которой выводится траектория инструмента УП в виде трехмерной (3D) проекции.
- Состояние контроллера ЧПУ в левом верхнем углу.
- Кнопки управления видом в правом верхнем углу.
- Информация о границах обработки УП в левом нижнем углу.
- Вспомогательная информация, выводимая в правом нижнем углу.

Траектория инструмента УП представлена набором отрезков линий:

- Сплошными черными отрезками выделены части траектории линейной и круговой интерполяции УП.
- Пунктирными черными - ускоренные движения.
- Красным цветом - вертикальные перемещения.

При передаче УП в контроллер ЧПУ часть отрезков меняет цвет в зависимости от следующих условий: часть траектории, обработанная ЧПУ, выделяется серым цветом; часть траектории, отправленная в ЧПУ - фиолетовым.

На траекторию УП нанесены три маркера-круга:

- Красный маркер - начало траектории.
- Зеленый маркер - конец траектории.
- Фиолетовый - отрезок траектории, соответствующий выделенной команде в таблице окна "G-код программа".

В основной области, также, отображается начало координат в виде прямоугольника красного цвета в плоскости X-Y, и осей: X - красного цвета, Y - зеленого, Z - синего. Здесь же выводится условное отображение инструмента в виде каркасной модели из линий оранжевого цвета.

Навигация в основной области выполняется следующим образом:

- Поворот 3D проекции осуществляется нажатием ЛКМ в основной области и перемещением курсора мыши в заданном направлении или нажатием на одну из кнопок управления видом в правом верхнем углу окна ("Вид сверху", "Вид спереди", "Вид слева", "Изометрия").
- Перемещении проекции в области осуществляется нажатием ЛКМ с удерживанием клавиши \<Shift\> клавиатуры и перемещением курсора мыши в заданном направлении.
- Масштаб проекции изменяется с помощью колеса прокрутки мыши или нажатием на кнопку "Вписать" в правом верхнем углу.

В левом верхнем углу окна расположена информация о текущем состоянии контроллера ЧПУ, а именно: строка состояния интерпретатора; текущие значения подачи и скорости вращения шпинделя; состояние компонентов ЧПУ (шпинделя, системы охлаждения).

Строка состояния имеет следующий вид:

<p class="center">[GC:G1 G54 G17 G21 G90 G94 M3 M9 T0 F75 S8000]</p>

В строке выводится текущий режим работы интерпретатора контроллера ЧПУ для 12 модальных групп, номер инструмента, скорость подачи и скорость вращения шпинделя. Группы и возможные режимы приведены в таблице 2.

Таблица 2 - Режимы работы интерпретатора контроллера ЧПУ

| Модальная группа                        | Режимы                                          |
|-----------------------------------------|:------------------------------------------------|
| Режим движения                          | G0, G1, G2, G3, G38.2, G38.3, G38.4, G38.5, G80 |
| Система координат                       | G54, G55, G56, G57, G58, G59                    |
| Рабочая плоскость                       | G17, G18, G19                                   |
| Режим задания дистанции перемещения     | G90, G91                                        |
| Режим IJK задания круговой интерполяции | G91.1                                           |
| Режим подачи                            | G93, G94                                        |
| Единицы измерения                       | G20, G21                                        |
| Режим компенсации радиуса инструмента   | G40                                             |
| Режим компенсации длины инструмента     | G43.1, G49                                      |
| Режим управления ходом программы        | M0, M1, M2, M30                                 |
| Состояние шпинделя                      | M3, M4, M5                                      |
| Состояние системы охлаждения            | M7, M8, M9                                      |

Строка состояния компонентов ЧПУ имеет вид:

<p class="center">СУ: SFM</p>

Символ "S" отвечает за состояние шпинделя, выводится при вращении шпинделя в направлении часовой стрелки, заменяется на символ "C" при вращении шпинделя против часовой стрелки и не выводится при остановке шпинделя. Символ "F" отображается при включенной системе водяного охлаждения, "M" - системе воздушного охлаждения.

Границы обработки УП приведены в левом нижнем углу, здесь указаны минимальные и максимальные координаты для каждой из осей и габариты зоны обработки (без учета диаметра инструмента).

В правом нижнем углу выводится информация о текущем времени работы ЧПУ под управлением загруженной УП и ориентировочное полное время работы по УП.

Информация об очереди команд, отправляемых в контроллер ЧПУ представлена в строке ниже и включает в себя: общий размер команд, отправленных и обрабатываемых в данный момент контроллером ЧПУ; количество обрабатываемых команд; количество инжектированных команд (команд отправляемых помимо команд УП) в очереди.

В этой же области имеется вспомогательная информация об общем количестве вершин, составляющих 3D проекцию, и значение количества кадров в секунду построения проекции.

#### 3.3.2.3 Окно "Камера"

Изображение с подключенной к ПЭВМ камеры выводится в окне "Камера" (рисунок 4).

![Окно "Камера"](images_ru/camera.png#center)
<p class="center">Рисунок 4 - Окно "Камера"</p>

Перемещение вида в окне производится с нажатой ЛКМ смещением курсора мыши в заданном направлении, изменение масштаба - колесом прокрутки мыши.

В окне имеются прицельные элементы: вертикальная, горизонтальная линии и окружность с центром в точке пересечения линий. Перемещение точки пересечения линий производится нажатием ЛКМ с удерживанием клавиши \<Shift\> клавиатуры и перемещением курсора мыши в заданном направлении.

Параметры, такие как: разрешение изображения камеры, цвет и толщина линий прицельных элементов, доступны в окне настроек программы.

#### 3.3.2.4 Окно "Консоль"

Для ручного управления ЧПУ, а также настройки и вывода информации о состоянии контроллера в программе предусмотрено окно "Консоль" (рисунок 5).

![Окно "Консоль"](images_ru/console.png#center)
<p class="center">Рисунок 5 - Окно "Консоль"</p>

В нижней части окна имеется поле ввода команды и две кнопки: "Отправить команду" и "Очистить консоль". В верхней части расположено многострочное поле вывода ответов от контроллера.

Для отправки команды в контроллер ЧПУ необходимо ввести ее в соответствующее поле и нажать клавишу \<Enter\> клавиатуры или кнопку "Отправить команду". После обработки команды контроллером, команда и ответ будут выведены в поле выше в следующем формате:

<p class="center">Команда < Ответ</p>

Если в настройках программы включен флаг "Отображать команды интерфейса пользователя" в поле выводов ответов будут отображены все команды, отправляемые в контроллер по нажатию элементов управления инструментальных панелей. При включенном флаге "Отображать команды G-code программы" - все команды УП при передаче УП в контроллер. 

Очистка поля вывода ответов производится нажатием на кнопку "Очистить консоль".

#### 3.3.2.5 Окна "Устройство", "Модификация", "Пользователь"

Инструментальные панели с элементами управления и отображения информации о состоянии ЧПУ располагаются в окнах "Устройство", "Модификация", "Пользователь".

Наименование окон характеризует функциональное назначение панелей, расположенных в них, но не ограничивает их состав - все панели могут свободно перемещаться как внутри соответствующего окна так и между окнами.

Перемещение осуществляется перетаскиванием панели за заголовок с нажатой ЛКМ. В процессе перетаскивания в окнах будет отображаться место будущего расположения панели в виде линии синего цвета.

Большинство инструментальных панелей имеют способность сворачиваться для экономии места на экране ПЭВМ, данные панели имеют знак "-" слева от наименования в заголовке в развернутом состоянии и "≡" - в свернутом. Сворачивание и разворачивание панели осуществляется щелчком ЛКМ на заголовке.

Текст заголовков панелей в нормальном состоянии имеет черный цвет, при активации важных функций панелей - красный. 

При запуске программы часть панелей отображается в неактивном состоянии и активируется только при подключении к ПЭВМ ЧПУ.

### 3.3.3 Инструментальные панели

#### 3.3.3.1 Панель "Состояние"

На панели "Состояние" (рисунок 6) выводятся текущие значения рабочих и машинных координат, а также режим работы контроллера ЧПУ. Координаты отображаются в полях вывода, расположенных по горизонтали в порядке: X, Y, Z.

Возможные режимы работы контроллера ЧПУ (поле "Статус") следующие:

- "Готов" - режим готовности к приему команд.
- "Тревога" - режим аварии.
- "Работа" - режим выполнения УП.
- "Дом" - поиск домашней позиции.
- "Удержание" - приостановка движения, ожидание дальнейших команд продолжения/сброса.
- "Проверка" - интерпретация входящих команд без фактического перемещения инструмента.
- "Дверь" - режим срабатывания датчика двери.
- "Перемещение" - режим выполнения специальных команд перемещения.
- "Сон" - режим пониженного энергопотребления.

В этом же поле выводятся состояния, не относящиеся к режиму работы контроллера:

- "Нет соединения" - при невозможности открыть последовательный порт подключения к ЧПУ.
- "Порт открыт" - при открытии последовательного порта, но отсутствии соединения с контроллером ЧПУ. 

Фон поля "Статус" может изменять цвет в зависимости от состояния.

![Панель "Состояние"](images_ru/status.png#center)
<p class="center">Рисунок 6 - Панель "Состояние"</p>

#### 3.3.3.2 Панель "Управление"

Панель "Управление" содержит набор кнопок, отвечающих за базовые функции контроллера "GRBL" (рисунок 7). Состав, посылаемые команды (коды команд), и описание приведены в таблице 3 в порядке их расположения на панели: слева направо, сверху вниз.

![Панель "Управление"](images_ru/control.png#center)
<p class="center">Рисунок 7 - Панель "Управление"</p>

Таблица 3 - Кнопки панели "Управления"

| Кнопка        | Команда     | Описание                                                                  |
|---------------|-------------|---------------------------------------------------------------------------|
| Домой         | $H          | Поиск домашнего положения                                                 |
| Удерживание   | ! или ~     | Остановка текущего перемещения (команда !) или возобновление движения (~) |
| Сброс         | 0x18        | Программный сброс контроллера                                             |
| Разблокировка | $X          | Принудительная разблокировка режима аварии                                |
| Проверка      | $C или 0x18 | Включение (команда $C)/выключение (команда 0x18) режима проверки УП       |
| Сон           | $SLP        | Перевод контроллера в режим пониженного энергопотребления                 |
| Дверь         | 0x84        | Принудительный перевод контроллера в режим срабатывания датчика двери     |
| Охлаждение    | 0xA0        | Включение/выключение системы водяного охлаждения                          |

Следует отметить, что при выключении режима проверки УП, посылается команда программного сброса с последующим восстановлением состояния контроллера и смещений рабочих координат.

#### 3.3.3.3 Панель "Система координат"

На рисунке 8 изображена панель управления системой координат ЧПУ (далее - СК).

![Панель "Система координат"](images_ru/coordinatesystem.png#center)
<p class="center">Рисунок 8 - Панель "Система координат"</p>

В верхней части панели выводятся смещения для активной СК для осей X, Y и Z, в нижней расположены кнопки выбора СК и обнуления текущих координат по оси X, Y, Z, всех осей одновременно для активной СК.

#### 3.3.3.4 Панель "Шпиндель"

На панели управления шпинделем (рисунок 9) расположены:

- Поле ввода для установки/вывода заданной скорости вращения шпинделя.
- Горизонтальный ползунок установки/вывода скорости.
- Кнопка включения/выключения шпинделя.

![Панель "Шпиндель"](images_ru/spindle.png#center)
<p class="center">Рисунок 9 - Панель "Шпиндель"</p>

Скорость вращения может задаваться как вводом числа в соответствующее поле, так и с помощью ползунка.

Текст в поле ввода может иметь два цвета: черный в случае, если текущая скорость вращения шпинделя соответствует заданной; красный - в противном случае.

Ползунок имеет ручку в виде круга серого цвета с контуром темного цвета, с помощью которой задается скорость вращения шпинделя и маркер в виде круга с более светлыми цветами, отображающий текущую скорость вращения.

Во время передачи УП в контроллер скорость вращения может быть изменена с помощью вышеуказанных элементов управления, при этом используются инжектированные G-код команды "S", или с помощью функции переопределения скорости панели "Коррекция". Включение/выключение шпинделя во время передачи возможно только при переводе контроллера в режим удерживания.

#### 3.3.3.5 Панель "Перемещение"

На панели "Перемещение" находятся элементы управления движением инструмента ЧПУ, а именно:

- Кнопки движения по осям X (стрелки влево, вправо), Y (стрелки вверх, вниз), Z (стрелки вверх, вниз, расположенные справа).
- Кнопка "Стоп", расположенная по центру кнопок движения по осям X и Y, отвечающая за принудительную остановку движения.
- Выпадающий список "Шаг", в котором можно задать шаг перемещения.
- Выпадающий список "Подача", отвечающий за выбор скорости перемещения.
- Флаг "Управление с клавиатуры", включающий управление перемещением с клавиатуры ПЭВМ.

![Панель "Перемещение"](images_ru/jogging.png#center)
<p class="center">Рисунок 10 - Панель "Перемещение"</p>

Списки "Шаг" и "Подача" имеют предварительные наборы шагов перемещения и скоростей соответственно, но позволяют ввести произвольные значения в поля списков. Введенные значения запоминаются при включении флага "Управление с клавиатуры" и могут выбираться из списков при последующем запуске программы.

Каждой кнопке панели, а также перелистыванию значений "Шаг" и "Подача" могут быть назначены быстрые клавиши, задаваемые в окне "Настройки" программы. Управление данными клавишами включается флагом "Управление с клавиатуры". 

#### 3.3.3.6 Панель "Коррекция"

На рисунке 11 представлен вид панели "Коррекция". На панели расположены элементы переопределения скорости подачи, скорости холостого хода и скорости вращения шпинделя во время отправки УП в контроллер ЧПУ.

Элементы аналогичны таковым, расположенным на панели "Шпиндель", за исключением замененной кнопки включения соответствующим флагом.

![Панель "Коррекция"](images_ru/overriding.png#center)
<p class="center">Рисунок 11 - Панель "Коррекция"</p>

#### 3.3.3.7 Панель "Карта высот"

Панель "Карта высот" (рисунок 12) отвечает за создание, загрузку, снятие карты неровности поверхности и дальнейшую коррекцию УП для нивелирования кривизны детали, обрабатываемой с помощью ЧПУ. Данная функция полезна при фрезеровке печатных плат и гравировке.

![Панель "Карта высот"](images_ru/heightmap.png#center)
<p class="center">Рисунок 12 - Панель "Карта высот"</p>

На панели имеются элементы создания, загрузки и включения режима работы с картой высот; задания границ прямоугольной зоны карты; установки количества точек зондирования по осям X и Y; установки рабочей высоты над поверхностью и глубины зондирования; установки скорости подачи; установки количества линий сетки разбиения УП по осям X и Y.

Коррекция УП по активной карте высот производится включением флага "Использовать карту высот".

Более подробная информация об использовании карты высот приведена в п. [3.7 "Создание карты высот"](#37-создание-карты-высот) данного руководства.

#### 3.3.3.8 Панель "Пользовательские команды"

Для расширения функционала программы в части управления ЧПУ предусмотрена панель "Пользовательские команды" (рисунок 13). На панели расположены кнопки, по нажатию на которые в контроллер ЧПУ отправляются заранее определенные команды.

![Панель "Пользовательские команды"](images_ru/usercommands.png#center)
<p class="center">Рисунок 13 - Панель "Пользовательские команды"</p>

Задание команд осуществляется в окне "Настройки" программы. В группе "Пользовательские команды" окна имеется таблица команд. В таблице имеется возможность добавить, удалить или переместить команду, а также задать атрибуты:

- Текстовую подсказку, отображаемую над кнопкой панели при наведении на нее курсора мыши.
- Значок кнопки.
- Список G-код команд, отправляемых в контроллер ЧПУ при нажатии на соответствующую кнопку панели.

Программа содержит ограниченный набор значков для кнопок, набор может расширяться пользовательскими значками нажатием на пункт "..." в конце выпадающего списка.

Список команд, отправляемых в ЧПУ, может иметь одну G-код команду или набор команд, по одной в каждой строке поля в ячейке "G-код" таблицы.

В G-код командах можно использовать вставки программного кода на языке программирования JavaScript, оформляемые внутри фигурных скобок, например:

- Команда обнуления рабочей координаты X и запоминания смещения в переменной "storedG92x"

``` javascript
G92X0
{var storedG92x = vars.G92x}
```

- Восстановление смещения координаты X после сброса контроллера ЧПУ

``` javascript
G92X{vars.Mx - storedG92x - vars.x}
```

- Запуск программы "Блокнот"

``` javascript
{script.importExtension("qt.core")}
{var p = new QProcess()}
{p.start("notepad", [])}
```

Подробнее об использовании языка программирования JavaScript в программе читайте в п. [5 "Разработка расширений"](#5-razrabotka-rasshireniy) данного руководства

## 3.4 Окно настроек

Настройки программы доступны в окне настроек (рисунок 14), вызываемое по активации пункта "Настройки" меню "Сервис" программы.

![Окно настроек](images_ru/settings.png#center)
<p class="center">Рисунок 14 - Окно настроек</p>

Окно содержит три области: область слева - список групп настроек; область справа - элементы управления настройками выбранной группы; область снизу - кнопка установки настроек в значения по-умолчанию, кнопки подтверждения и отмены изменений настроек.

Ниже приведена информация о доступных настройках программы: группа, параметр, описание, допустимые значения, значение по-умолчанию.

Таблица 4 - Настройки программы

| Группа                       | Параметр                                                            | Описание                                                                                         | Допустимые значения                                          | Значение по-умолчанию |
|------------------------------|---------------------------------------------------------------------|--------------------------------------------------------------------------------------------------|--------------------------------------------------------------|-----------------------|
| Соединение                   | Порт                                                                | Последовательный порт соединения с контроллером ЧПУ                                              | Путь к устройству                                            | Пусто                 |
|                              | Скорость                                                            | Скорость обмена по последовательному порту                                                       | 9600, 14400, 19200, 38400, 57600, 115200, произвольное число | 115200                |
|                              | Период опроса                                                       | Время между запросами состояния контроллера                                                      | от 10 до 9999 мс                                             | 100                   |
| Информация о станке          | Скорость шпинделя мин.                                              | Минимальная скорость вращения шпинделя (используется панелью "Шпиндель")                         | от 0 до 99999 об/мин                                         | 0                     |
|                              | Скорость шпинделя макс.                                             | Максимальная скорость вращения шпинделя                                                          | от 0 до 99999 об/мин                                         | 10000                 |
|                              | Мощность лазера мин.                                                | Минимальная мощность лазера (используется при полутоновом окрашивании растровой визуализации УП) | от 0 до 99999                                                | 0                     |
|                              | Мощность лазера макс.                                               | Максимальная мощность лазера                                                                     | от 0 до 99999                                                | 100                   |
| Парсер                       | Размер сегментов, аппроксимирующих дуги - по длине                  | Длина отрезков, разбивающих дуги УП, при отображении в окне "Визуализатор" и работе карты высот  | от 0.1 до 99 мм                                              | 0.1 (выключено)       |
|                              | Размер сегментов, аппроксимирующих дуги - по углу                   | Угол разбития дуг УП, при отображении в окне "Визуализатор" и работе карты высот                 | от 0 до 180 градусов                                         | 5 градусов (включено) |
| Отправка файла               | Команды начала программы                                            | G-код команды, отправляемые в контроллер ЧПУ перед передачей УП                                  | Набор G-код команд (допустимо использование JavaScript)      | Пусто                 |
|                              | Команды конца программы                                             | G-код команды, отправляемые в контроллер ЧПУ после передачи УП                                   | Набор G-код команд (допустимо использование JavaScript)      | Пусто                 |
|                              | Команды смены инструмента                                           | G-код команды, отправляемые в контроллер ЧПУ при обработке команд смены инструмента              | Набор G-код команд (допустимо использование JavaScript)      | Пусто                 |
|                              | Игнорировать ошибки при отправке файла                              | Флаг, управляющий остановкой передачи УП при возникновении ошибок обработки команд контроллером  | Включено, выключено                                          | Выключено             |
|                              | Автоматически настраивать парсер перед отправкой с выбранной строки | Включение отправки команд настройки интерпретатора перед отправкой УП с выбранной строки         | Включено, выключено                                          | Включено              |
|                              | Приостанавливать передачу файла по командам смены инструмента       | Управление приостановкой передачи УП при обработке команд смены инструмента                      | Включено, выключено                                          | Включено              |
| Визуализатор                 | Толщина линий                                                       | Толщина линий 3D проекции УП                                                                     | от 1 до 9                                                    | 1.5                   |
|                              | Сглаживание                                                         | Управление сглаживанием линий 3D проекции УП                                                     | Включено, выключено                                          | Включено              |
|                              | MSAA                                                                | Сглаживание линий 3D проекции УП методом MSAA                                                    | Включено, выключено                                          | Включено              |
|                              | Частота кадров                                                      | Частота кадров построения 3D проекции УП                                                         | 30, 60, 120, произвольное число                              | 60                    |
|                              | V-sync                                                              | Управление вертикальной синхронизацией                                                           | Включено, выключено                                          | Выключено             |
|                              | Буфер глубины                                                       | Управление перекрытием линий в зависимости от удаленности при построении 3D проекции УП          | Включено, выключено                                          | Выключено             |
|                              | Режим отрисовки                                                     | Метод построения проекции УП, "Векторный" - в виде отрезков линий, "Растр" - в виде набора точек | Векторный, растр                                             | Векторный             |
|                              | Упростить геометрию                                                 | Ограничение минимального размера сегмента УП при отрисовке проекции УП                           | Включено, выключено                                          | Включено              |
|                              | Упростить геометрию - Точность                                      | Минимальный размер сегмента УП (при нуле преобразуются только сегменты, лежащие на одной линии)  | от 0 до 99 мм                                                | 0                     |
|                              | Полутоновое окрашивание                                             | Управляет функцией окрашивания точек при растровом построении проекции                           | Включено, выключено                                          | Выключено             |
|                              | Полутоновое окрашивание - По 'S'-коду                               | Управляет функцией окрашивания точек по "S"-коду УП                                              | Включено, выключено                                          | Включено              |
|                              | Полутоновое окрашивание - По 'Z'-коду                               | Управляет функцией окрашивания точек по "Z"-коду УП                                              | Включено, выключено                                          | Выключено             |
| Цвета                        | Визуализатор - Фон                                                  | Задает цвет фона в окне "Визуализатор"                                                           | Произвольный цвет                                            | Белый                 |
|                              | Визуализатор - Текст                                                | Задает цвет текста в окне "Визуализатор"                                                         | Произвольный цвет                                            | Черный                |
|                              | Визуализатор - Фреза                                                | Задает цвет модели инструмента в окне "Визуализатор"                                             | Произвольный цвет                                            | Оранжевый             |
|                              | Траектория - Основной                                               | Задает цвет рабочих ходов траектории в проекции УП                                               | Произвольный цвет                                            | Черный                |
|                              | Траектория - Выполненная                                            | Задает цвет частей траектории, обработанных ЧПУ при передаче УП в контроллер                     | Произвольный цвет                                            | Серый                 |
|                              | Траектория - Подсветка                                              | Задает цвет частей траектории, отправленных в ЧПУ, цвет маркера выбранной строки УП              | Произвольный цвет                                            | Фиолетовый            |
|                              | Траектория - Z-перемещения                                          | Задает цвет вертикальных перемещений траектории                                                  | Произвольный цвет                                            | Красный               |
|                              | Траектория - Начало                                                 | Задает цвет маркера начала УП                                                                    | Произвольный цвет                                            | Красный               |
|                              | Траектория - Конец                                                  | Задает цвет маркера конца УП                                                                     | Произвольный цвет                                            | Зеленый               |
| Модель фрезы                 | Тип                                                                 | Вид модели инструмента в окне "Визуализатор"                                                     | Плоская, коническая                                          | Коническая            |
|                              | Угол                                                                | Угол конуса конической модели инструмента                                                        | от 0 до 180 градусов                                         | 15                    |
|                              | Диаметр                                                             | Диаметр модели инструмента                                                                       | от 0 до 99 мм                                                | 3                     |
|                              | Длина                                                               | Длина модели инструмента                                                                         | от 0 до 999 мм                                               | 30                    |
| Быстрые клавиши              | -                                                                   | Комбинации клавиш для быстрого вызова функций программы                                          | Произвольные комбинации клавиш                               | Пусто                 |
| Консоль                      | Отображать команды G-code программы                                 | Управляет отображением G-код команд УП в окне "Консоль" во время передачи УП в контроллер        | Включено, выключено                                          | Выключено             |
|                              | Отображать команды интерфейса пользователя                          | Управляет отображением G-код команд, отправляемых с помощью элементов инструментальных панелей   | Включено, выключено                                          | Включено              |
|                              | Автозавершение команды                                              | Автоматическое завершение команды при вводе в поле окна "Консоль" на основе введенных прежде     | Включено, выключено                                          | Включено              |
| Пользовательский интерфейс   | Размер шрифта                                                       | Размер шрифта пользовательского интерфейса программы                                             | 8, 9, 10, 11, 12 пт или произвольное число                   | 9                     |
|                              | Язык интерфейса                                                     | Язык надписей пользовательского интерфейса программы                                             | American English, русский (список может пополняться)         | American English      |
| Камера                       | Наименование                                                        | Наименование камеры, изображение которой выводится в окне "Камера"                               | Список доступных камер, произвольное наименование            | Пусто                 |
|                              | Разрешение                                                          | Разрешение изображения, выводимого с камеры                                                      | Список поддерживаемых разрешений, произвольное разрешение    | 1280x720              |
|                              | Позиция                                                             | Смещение изображения камеры в окне "Камера" по горизонтали и вертикали                           | Произвольное смещение в точках                               | 0, 0                  |
|                              | Масштаб                                                             | Коэффициент масштабирования изображения камеры                                                   | Произвольное число                                           | 1                     |
|                              | Позиция перекрестья                                                 | Относительное смещение прицельных элементов по горизонтали и вертикали                           | Произвольное смещение в относительных единицах от 0 до 1     | 0, 0                  |
|                              | Размер перекрестья                                                  | Диаметр прицельной окружности                                                                    | от 1 до 100                                                  | 20                    |
|                              | Цвет перекрестья                                                    | Цвет прицельных элементов                                                                        | Произвольный цвет                                            | Красный               |
|                              | Толщина линии                                                       | Толщина линий прицельных элементов                                                               | от 0 до 100                                                  | 1                     |
| Пользовательские команды     | -                                                                   | Таблица команд панели "Пользовательские команды"                                                 | Произвольный набор команд                                    | Тестовые команды      |

## 3.5 Подготовка программы к работе

Перед работой с программой необходимо выполнить следующие действия:

- Запустить программу.
- Подключить и запустить станок ЧПУ.
- Настроить порт и скорость подключения к контроллеру ЧПУ.
- Убедиться в наличии подключения к контролеру. При корректном подключении к контроллеру в поле "Статус" панели "Состояние" должно отобразиться режим "Готов".
- Проверить настройки контроллера.

Для проверки настроек нужно ввести команду "$$" в поле ввода окна "Консоль" и отправить ее в контроллер.
Корректность работы программы зависит от следующих настроек (см. [Приложение А. Настройки контроллера](#приложение-а-настройки-контроллера)):

- $5, $6 влияют на работу функции поиска домашнего положения и зонда.
- $10 должен содержать в маске вывод машинных координат, пример рабочего значения - 1.
- $22 определяет использование концевых выключателей при поиске домашнего положения, пример рабочего значения - 1.
- $23 задает направление движения по осям при поиске домашнего положения.
- $30, $31 задает диапазон оборотов шпинделя, может соответствовать настройкам "Скорость шпинделя мин.", "Скорость шпинделя макс." программы.
- $100...$102 определяют реальные значения перемещения по осям при отправке команд перемещения.
- $110...$112 - максимальные скорости перемещения по осям.
- $120...$122 - ускорения при перемещениях.
- $130...$132 определяют размер рабочего поля, используется в командах ручного перемещения инструмента.

Установка новых значений производится отправкой в контроллер команд вида $КОД=ЗНАЧЕНИЕ, например, $10=1.
После изменения настроек контроллера рекомендуется произвести его сброс нажатием на кнопку "Сброс" панели "Управление".

## 3.6 Загрузка управляющей программы

В качестве примера будет рассматриваться УП фрезеровки дорожек печатной платы (см. файл "level_shifter.gcode" в папке "doc/programexamples"), т.к. позволяет затронуть большинство функций программы.

Загрузка УП осуществляется командой "Открыть" меню "Файл" или нажатием на одноименную кнопку окна "G-code программа". После выбора файла УП и подтверждения открытия в окне "Визуализатор" отобразится траектория УП, границы обработки, примерное время исполнения УП.

Подготовка к исполнению УП включает следующие действия:

- Фиксация заготовки на рабочем столе (при фрезеровке заготовка, как правило, располагается на "жертвенном" столе).
- Поиск домашнего положения (кнопка "Домой" панели "Управление").
- Установка инструмента.
- Задание рабочего нуля системы координат.

С помощью кнопок панели "Перемещение" инструмент устанавливается в заданный ноль X и Y системы координат на заготовке.
Производится обнуление рабочих координат X и Y.

Здесь следует отметить, что задать рабочий ноль можно с помощью кнопок обнуления координат по осям на панели "Пользовательские команды" и "Система координат". В первом случае, при сбросе контроллера, или внештатной остановке исполнения УП, рабочие координаты не восстанавливаются. Во втором, значения хранятся в энергонезависимой памяти контроллера и восстанавливаются даже при отключении и повторной подаче питания. Выбор за пользователем, но рекомендуется использовать кнопки обнуления координат панели "Система координат", для координаты Z можно использовать кнопки панели "Пользовательские команды", т.к. Z зависит от длины установленного инструмента и, как правило, задается непосредственно перед началом исполнения УП.

Задание рабочего нуля Z можно произвести вручную, по аналогии с X и Y, или используя команду зондирования на панели "Пользовательские команды". Подключение и настройку зонда произвести в соответствии с инструкцией на станок ЧПУ.

## 3.7 Создание карты высот

Т.к. фрезеровка печатной платы осуществляется на глубину в несколько сотых долей миллиметра, рекомендуется выполнять ее с предварительным снятием карты неровности поверхности заготовки и модификацией исходной УП в соответствии с картой.

Необходимые действия:

- Убедиться, что рабочий ноль Z координаты лежит на поверхности заготовки.
- Нажать кнопку "Создать" панели "Карта высот".
- Нажать кнопку "Авто" для задания границ карты, убедиться, что УП находится в границах.
- Задать точку отчета карты высот. Именно в этой точке необходимо будет производить установку рабочего нуля по Z для исполнения УП. Если УП для одной заготовки несколько, нужно учитывать возможность зондирования в этой точке после промежуточных этапов обработки заготовки.
- Настроить сетку зондирования: задать количество проб по осям (в нашем случае задать 3 на 4), задать безопасную высоту по Z (Zв = 5) и глубину зондирования (Zн = -1), установить величину подачи (F = 50).
- Настроить сетку интерполяции, задаются величины, как минимум в 10 раз превышающие количество проб. Влияет на точность обработки отдельных сегментов УП на поверхности заготовки.
- Нажать на кнопку "Зонд" в окне "Карта высот", дождаться окончания процесса зондирования.
- При использовании нескольких УП для одной заготовки рекомендуется сохранить карту высот выбором пункта "Сохранить" меню "Файл" в режиме редактирования карты высот. Для последующих УП можно загрузить созданную карту нажатием на кнопку "Открыть" панели "Карта высот".
- Нажать на кнопку "Правка" панели "Карта высот" для выхода из режима редактирования карты высот.
- Включить флаг "Использовать карту высот" для модификации УП.
- Задать рабочий ноль по координате Z для полученной карты высот, для чего: поднять инструмент на безопасную высоту, нажать на кнопку "В ноль" панели "Карта высот" для перемещения в точку отсчета по координатам X и Y, установить рабочий Z вручную или используя команду зондирования панели "Пользовательские команды".

## 3.8 Выполнение управляющей программы

Запуск исполнения УП производится нажатием на кнопку "Отправить" окна "G-code программа".

После нажатия на кнопку "Отправить" на панели "Состояние" должен отобразиться статус "Работа".

По завершении отобразится окно с соответствующим сообщением.

Во время исполнения УП доступны команды:

- "Пауза" окна "G-code программа" - приостанавливает отправку УП в контроллер.
- "Прервать" окна "G-code программа" - останавливает отправку УП в контроллер.
- "Удерживание" панели "Управление" - приостановка исполнения команд контроллером (в отличии от команды "Пауза" действует мгновенно). В режиме удерживания также доступна кнопка "Вкл/выкл шпиндель" панели "Шпиндель". Продолжить исполнение УП можно повторным нажатием на кнопку "Удерживание".
- "Сброс" панели "Управление" - мгновенная остановка исполнения команд контроллером и остановка отправки УП в контроллер.
- Коррекция скорости подачи, холостого хода и вращения шпинделя панели "Коррекция".

## 3.9 Завершение работы с программой

Для завершения работы с программой необходимо выполнить следующие действия:

- Убедиться, что УП не передается в контроллер.
- Отключить питание станка.
- Закрыть программу с помощью пункта "Выход" меню "Файл" или других средств оконного менеджера операционной системы.

# 4 Сообщения оператору

В процессе работы программы оператору могут выводиться сообщения во всплывающих окнах.

К таковым относятся:

- Окно по завершении исполнения УП с информацией о времени исполнения и кнопкой подтверждения.
- Окно об ошибках передачи УП в контроллер с кнопками "Пропустить" для продолжения передачи и "Прервать" для остановки.
- Окно с предупреждением при закрытии программы при активном процессе передачи УП в контроллер.
- Окно с подтверждением отправки команд настройки парсера при вызове функции "Отправить с текущей строки" долгим нажатием на кнопку "Отправить" окна "G-code программа" и включенном флаге "Автоматически настраивать парсер перед отправкой с выбранной строки" группы "Отправка файла" в настройках программы.
- Другие вспомогательные окна.

# 5 Разработка расширений

Для добавления новых функций в программу, в т.ч. новых элементов пользовательского интерфейса, предусмотрен механизм расширений.

Каждое расширение должно быть оформлено в виде папки, содержащей набор файлов:

- Файл конфигурации "config.ini" - текстовый файл с описанием расширения.
- Файл скрипта "script.js" - код расширения.
- Вспомогательные файлы (файлы форм "\*.ui", настройки расширения, файлы переводов, изображения и т.д.)

Папка расширения должна храниться в каталоге "candleplugins" папки установки программы.

В программе предустановлены три расширения: "camera", "coordinatesytem" и "usercommands" отвечающие за функционал панелей "Камера", "Система координат", "Пользовательские команды" соответственно.

Набор расширений программы может со временем пополняться.

# 5.1 Файл конфигурации расширения

Файл конфигурации должен содержать два текстовых ключа в группе "General":

- "title" - заголовок окна и/или панели расширения.
- "name" - уникальное наименование расширения, записанное без пробелов.

Пример файла конфигурации расширения "Система координат":

```
[General]
title="Coordinate system"
name="CoordinateSystemPlugin"
```

# 5.2 Файл скрипта

Код расширения должен быть выполнен на языке программирования "JavaScript" и реализовывать функционал расширения.

Расширение может предоставлять пользовательский интерфейс панели для окон "Устройство", "Модификация", "Пользователь", отдельного окна в главном окне программы, интерфейс для окна настроек, так и не иметь его.

При необходимости настройки расширения при запуске программы и/или создания элементов пользовательского интерфейса код расширения может содержать следующие функции:

Таблица 5 - Функции скрипта

| Функция              | Аргументы   | Возвращаемое значение | Описание                                                                  |
|----------------------|-------------|-----------------------|---------------------------------------------------------------------------|
| init                 | -           | -                     | Функция инициализации расширения                                          |
| createPanelWidget    | -           | Объект типа "QWidget" | Функция создания пользовательского интерфейса панели                      |
| createWindowWidget   | -           | Объект типа "QWidget" | Функция создания пользовательского интерфейса для главного окна программы |
| createSettingsWidget | -           | Объект типа "QWidget" | Функция создания пользовательского интерфейса для окна настроек программы |

Вызов данных функций производится главной программой при загрузке расширения в порядке их перечисления в таблице.

В коде скрипта доступны глобальные объекты связи с главной программой, их описание приведено в таблице 6.

Таблица 6 - Объекты скрипта

| Объект       | Свойство             | Тип свойства | Аргументы               | Возвращаемое значение | Описание                                                                                                   |
|--------------|----------------------|--------------|-------------------------|----------------------|------------------------------------------------------------------------------------------------------------|
| app          | addAction            | Функция      | Действие                | -                    | Добавление в программу действия - объекта типа "QAction", для которого могут быть назначены быстрые клавиши |
|              | removeAction         | Функция      | Действие                | -                    | Удаление из программы действия                                                                             |
|              | newFile              | Функция      | -                       | -                    | Создание новой УП                                                                                          |
|              | loadFile             | Функция      | Имя файла               | -                    | Загрузка УП из файла                                                                                       |
|              | loadFile             | Функция      | Список команд           | -                    | Загрузка УП из списка команд                                                                               |
|              | saveFile             | Функция      | -                       | -                    | Сохранение УП                                                                                              |
|              | saveFile             | Функция      | Имя файла               | -                    | Сохранение УП в указанный файл                                                                             |
|              | settingsAboutToLoad  | Сигнал       | -                       | -                    | Сигнал, генерируемый перед загрузкой настроек программы                                                    |
|              | settingsLoaded       | Сигнал       | -                       | -                    | Сигнал, генерируемый после загрузки настроек программы                                                     |
|              | settingsAboutToSave  | Сигнал       | -                       | -                    | Сигнал, генерируемый перед записью настроек программы                                                      |
|              | settingsSaved        | Сигнал       | -                       | -                    | Сигнал, генерируемый после записи настроек программы                                                       |
|              | settingsAboutToShow  | Сигнал       | -                       | -                    | Сигнал, генерируемый перед вызовом окна настроек программы                                                 |
|              | settingsAccepted     | Сигнал       | -                       | -                    | Сигнал, генерируемый при подтверждении изменений настроек программы                                        |
|              | settingsRejected     | Сигнал       | -                       | -                    | Сигнал, генерируемый при отмене изменений настроек программы                                               |
|              | settingsSetByDefault | Сигнал       | -                       | -                    | Сигнал, генерируемый при установке настроек программы в значения по-умолчанию                              |
|              | pluginsLoaded        | Сигнал       | -                       | -                    | Сигнал, генерируемый после загрузки всех расширений программы                                              |
|              | buttonSize           | Значение     | -                       | -                    | Стандартный размер кнопок для панелей программы                                                            |
|              | path                 | Значение     | -                       | -                    | Абсолютный путь к папке установки программы                                                                |
|              | profileName          | Значение     | -                       | -                    | Наименование активного профиля настроек                                                                    |
|              | dataLocation         | Значение     | -                       | -                    | Путь к данным приложения                                                                                   |
|              | device               | Объект       | -                       | -                    | Объект для работы с контроллером ЧПУ                                                                       |
|              | program              | Объект       | -                       | -                    | Объект для работы с загруженной УП                                                                         |
|              | sender               | Объект       | -                       | -                    | Объект контроля отправки УП в контроллер ЧПУ                                                               |
|              | settings             | Объект       | -                       | -                    | Объект настроек программы                                                                                  |
|              | storage              | Объект       | -                       | -                    | Объект для работы с хранилищем данных                                                                      |
|              | window               | Объект       | -                       | -                    | Объект главного окна программы                                                                             |
| app.device   | sendCommand          | Функция      | Команда, индекс команды | -                    | Отправка команды в контроллер ЧПУ, может иметь индекс - отрицательное число, меньшее -99                   |
|              | sendCommands         | Функция      | Список команд, индекс команд  | -               | Отправка списка команд в контроллер ЧПУ                                                                    |
|              | sendCommands         | Функция      | Команды, индекс команд  | -                    | Отправка списка команд в виде строки с разделителем '\n' в контроллер ЧПУ                                  |
|              | storeParserState     | Функция      | -                       | -                    | Сохранение текущего состояния парсера                                                                      |
|              | restoreParserState   | Функция      | -                       | -                    | Восстановление текущего состояния парсера                                                                  |
|              | waitResponses        | Функция      | -                       | -                    | Ожидание ответов всех команд, отправленных ранее в контроллер ЧПУ                                          |
|              | bufferLength         | Значение     | -                       | -                    | Суммарный размер команд, находящихся в буфере контроллера ЧПУ                                              |
|              | commandLength        | Значение     | -                       | -                    | Количество команд, находящихся в буфере контроллера ЧПУ                                                    |
|              | queueLength          | Значение     | -                       | -                    | Количество команд, находящихся в очереди на отправку в контроллер ЧПУ                                      |
|              | machine              | Значение     | -                       | -                    | Текущие машинные координаты                                                                                |
|              | probe                | Значение     | -                       | -                    | Последние полученные координаты зонда                                                                      |
|              | state                | Значение     | -                       | -                    | Состояние контроллера ЧПУ                                                                                  |
|              | work                 | Значение     | -                       | -                    | Текущие рабочие координаты                                                                                 |
|              | responseReceived     | Сигнал       | Команда, индекс, ответ  | -                    | Сигнал приема ответа от контроллера ЧПУ на ранее отправленную команду                                      |
|              | statusReceived       | Сигнал       | Статус                  | -                    | Сигнал приема статуса контроллера, содержит строку ответа контроллера на команду "?"                       |
|              | stateChanged         | Сигнал       | Состояние               | -                    | Сигнал смены состояния контроллера ЧПУ, описание состояний приведено в таблице 8                           |
| app.program  | lowerBounds          | Значение     | -                       | -                    | Нижние границы обработки УП                                                                                |
|              | upperBounds          | Значение     | -                       | -                    | Верхни границы обработки УП                                                                                |
| app.sender   | stateChanged         | Сигнал       | Состояние               | -                    | Сигнал смены состояния передачи УП в контроллер ЧПУ, описание состояний приведено в таблице 7              |
|              | state                | Значение     | -                       | -                    | Текущее состояние передачи УП в контроллер ЧПУ                                                             |
| app.settings | port                 | Значение     | -                       | -                    | Параметр "Соединение - Порт" настроек программы                                                            |
|              | baud                 | Значение     | -                       | -                    | Параметр "Соединение - Скорость"                                                                           |
|              | queryStateTime       | Значение     | -                       | -                    | Параметр "Соединение - Период опроса"                                                                      |
|              | spindleSpeedMin      | Значение     | -                       | -                    | Параметр "Информация о станке - Скорость шпинделя мин."                                                    |
|              | spindleSpeedMax      | Значение     | -                       | -                    | Параметр "Информация о станке - Скорость шпинделя макс."                                                   |
|              | laserPowerMin        | Значение     | -                       | -                    | Параметр "Информация о станке - Мощность лазера мин."                                                      |
|              | laserPowerMax        | Значение     | -                       | -                    | Параметр "Информация о станке - Мощность лазера макс."                                                     |
|              | axisAEnabled         | Значение     | -                       | -                    | Параметр "Информация о станке - Задействовать ось 'A'"                                                     |
|              | axisAX               | Значение     | -                       | -                    | Параметр "Информация о станке - Задействовать ось 'A' - Направление - X"                                   |
|              | arcLength            | Значение     | -                       | -                    | Параметр "Размер сегментов, аппроксимирующих дуги - по длине"                                              |
|              | arcDegree            | Значение     | -                       | -                    | Параметр "Размер сегментов, аппроксимирующих дуги - по углу"                                               |
|              | arcDegreeMode        | Значение     | -                       | -                    | Включение/выключение режима "Размер сегментов, аппроксимирующих дуги - по углу"                            |
|              | startCommands        | Значение     | -                       | -                    | Параметр "Отправка файла - Команды начала программы"                                                       |
|              | endCommands          | Значение     | -                       | -                    | Параметр "Отправка файла - Команды конца программы"                                                        |
|              | toolChangeCommands   | Значение     | -                       | -                    | Параметр "Отправка файла - Команды смены инструмента"                                                      |
|              | ignoreErrors         | Значение     | -                       | -                    | Параметр "Отправка файла - Игнорировать ошибки при отправке файла"                                         |
|              | autoLine             | Значение     | -                       | -                    | Параметр "Отправка файла - Автоматически настраивать парсер перед отправкой с выбранной строки"            |
|              | pauseToolChange      | Значение     | -                       | -                    | Параметр "Отправка файла - Приостанавливать передачу файла по командам смены инструмента"                  |
|              | lineWidth            | Значение     | -                       | -                    | Параметр "Визуализатор - Толщина линий"                                                                    |
|              | antialiasing         | Значение     | -                       | -                    | Параметр "Визуализатор - Сглаживание"                                                                      |
|              | msaa                 | Значение     | -                       | -                    | Параметр "Визуализатор - MSAA"                                                                             |
|              | fps                  | Значение     | -                       | -                    | Параметр "Визуализатор - Частота кадров"                                                                   |
|              | vsync                | Значение     | -                       | -                    | Параметр "Визуализатор - V-sync"                                                                           |
|              | zBuffer              | Значение     | -                       | -                    | Параметр "Визуализатор - Буфер глубины"                                                                    |
|              | drawModeVectors      | Значение     | -                       | -                    | Параметр "Визуализатор - Режим отрисовки" (0 - растр, 1 - векторный)                                       |
|              | simplify             | Значение     | -                       | -                    | Параметр "Визуализатор - Упростить геометрию"                                                              |
|              | simplifyPrecision    | Значение     | -                       | -                    | Параметр "Визуализатор - Упростить геометрию - Точность"                                                   |
|              | grayscaleSegments    | Значение     | -                       | -                    | Параметр "Визуализатор - Полутоновое окрашивание"                                                          |
|              | grayscaleSCode       | Значение     | -                       | -                    | Параметр "Визуализатор - Полутоновое окрашивание - По 'S'-коду"                                            |
|              | toolType             | Значение     | -                       | -                    | Параметр "Модель фрезы - Тип" (0 - плоская, 1 - коническая)                                                |
|              | toolAngle            | Значение     | -                       | -                    | Параметр "Модель фрезы - Угол"                                                                             |
|              | toolDiameter         | Значение     | -                       | -                    | Параметр "Модель фрезы - Диаметр"                                                                          |
|              | toolLength           | Значение     | -                       | -                    | Параметр "Модель фрезы - Длина"                                                                            |
|              | showProgramCommands  | Значение     | -                       | -                    | Параметр "Консоль - Отображать команды G-code программы"                                                   |
|              | showUICommands       | Значение     | -                       | -                    | Параметр "Консоль - Отображать команды интерфейса пользователя"                                            |
|              | autoCompletion       | Значение     | -                       | -                    | Параметр "Консоль - Автозавершение команды"                                                                |
|              | fontSize             | Значение     | -                       | -                    | Параметр "Пользовательский интерфейс - Размер шрифта"                                                      |
|              | language             | Значение     | -                       | -                    | Параметр "Пользовательский интерфейс - Язык интерфейса" (ISO 639-1)                                        |
|              | units                | Значение     | -                       | -                    | Единицы измерения ЧПУ (0 - метрические, 1 - дюймовые)                                                      |
|              | rapidSpeed           | Значение     | -                       | -                    | Скорость ускоренных перемещений ЧПУ                                                                        |
|              | acceleration         | Значение     | -                       | -                    | Ускорение перемещений ЧПУ                                                                                  |
|              | machineBounds        | Значение     | -                       | -                    | Границы перемещений ЧПУ                                                                                    |
|              | homingEnabled        | Значение     | -                       | -                    | Флаг функции поиска домашнего положения ЧПУ                                                                |
|              | softLimitsEnabled    | Значение     | -                       | -                    | Флаг программных границ ЧПУ                                                                                |
| app.storage  | group                | Функция      | Ключ группы             | Объект группы        | Получение объекта-группы данных внутри хранилища по указанному ключу                                       |
|              | setValue             | Функция      | Ключ, значение          | -                    | Запись данных в хранилище по полному ключу                                                                 |
|              | value                | Функция      | Ключ                    | Значение             | Чтение данных из хранилища по полному ключу                                                                |
|              | contains             | Функция      | Ключ                    | Наличие данных       | Проверка наличия данных по полному ключу                                                                   |
|              | remove               | Функция      | Ключ                    | -                    | Удаление данных по полному ключу                                                                           |
| app.storage.group  | group          | Функция      | Ключ группы             | Объект группы        | Получение объекта-подгруппы данных внутри хранилища по указанному ключу                                    |
|              | setValue             | Функция      | Ключ, значение          | -                    | Запись данных в хранилище по ключу                                                                         |
|              | value                | Функция      | Ключ                    | Значение             | Чтение данных из хранилища по ключу                                                                        |
|              | contains             | Функция      | Ключ                    | Наличие данных       | Проверка наличия данных по ключу                                                                           |
|              | remove               | Функция      | Ключ                    | -                    | Удаление данных по ключу                                                                                   |
|              | childKeys            | Функция      | -                       | Список ключей        | Получение списка ключей в группе                                                                           |
|              | childGroups          | Функция      | -                       | Список ключей подгрупп | Получение списка подгрупп                                                                                  |
| vars         | Mx                   | Значение     | -                       | -                    | Текущая машинная координата X                                                                              |
|              | My                   | Значение     | -                       | -                    | Текущая машинная координата Y                                                                              |
|              | Mz                   | Значение     | -                       | -                    | Текущая машинная координата Z                                                                              |
|              | Wx                   | Значение     | -                       | -                    | Текущая рабочая координата X                                                                               |
|              | Wy                   | Значение     | -                       | -                    | Текущая рабочая координата Y                                                                               |
|              | Wz                   | Значение     | -                       | -                    | Текущая рабочая координата Z                                                                               |
|              | G54x                 | Значение     | -                       | -                    | Смещение координаты X системы координат G54                                                                |
|              | G54y                 | Значение     | -                       | -                    | Смещение координаты Y системы координат G54                                                                |
|              | G54z                 | Значение     | -                       | -                    | Смещение координаты Z системы координат G54                                                                |
|              | ...                  | ...          | ...                     | ...                  | ...                                                                                                        |       
|              | G59x                 | Значение     | -                       | -                    | Смещение координаты X системы координат G59                                                                |
|              | G59y                 | Значение     | -                       | -                    | Смещение координаты Y системы координат G59                                                                |
|              | G59z                 | Значение     | -                       | -                    | Смещение координаты Z системы координат G59                                                                |
|              | CS                   | Значение     | -                       | -                    | Текущая система координат - строка "G54" ... "G59"                                                         |
|              | x                    | Значение     | -                       | -                    | Смещение координаты X текущей системы координат                                                            |
|              | y                    | Значение     | -                       | -                    | Смещение координаты Y текущей системы координат                                                            |
|              | z                    | Значение     | -                       | -                    | Смещение координаты Z текущей системы координат                                                            |
|              | G92x                 | Значение     | -                       | -                    | Смещение рабочей координаты X                                                                              |
|              | G92y                 | Значение     | -                       | -                    | Смещение рабочей координаты Y                                                                              |
|              | G92z                 | Значение     | -                       | -                    | Смещение рабочей координаты Z                                                                              |
|              | G28x                 | Значение     | -                       | -                    | Сохраненная координата X команды G28                                                                       |
|              | G28y                 | Значение     | -                       | -                    | Сохраненная координата Y команды G28                                                                       |
|              | G28z                 | Значение     | -                       | -                    | Сохраненная координата Z команды G28                                                                       |
|              | G30x                 | Значение     | -                       | -                    | Сохраненная координата X команды G30                                                                       |
|              | G30y                 | Значение     | -                       | -                    | Сохраненная координата Y команды G30                                                                       |
|              | G30z                 | Значение     | -                       | -                    | Сохраненная координата Z команды G30                                                                       |
|              | TLOx                 | Значение     | -                       | -                    | Смещение инструмента по координате X                                                                       |
|              | TLOy                 | Значение     | -                       | -                    | Смещение инструмента по координате Y                                                                       |
|              | TLOz                 | Значение     | -                       | -                    | Смещение инструмента по координате Z                                                                       |
|              | PRBx                 | Значение     | -                       | -                    | Координата X касания при зондировании                                                                      |
|              | PRBy                 | Значение     | -                       | -                    | Координата Y касания при зондировании                                                                      |
|              | PRBz                 | Значение     | -                       | -                    | Координата Z касания при зондировании                                                                      |
|              | tool                 | Значение     | -                       | -                    | Номер текущего инструмента                                                                                 |
| script       | importExtension      | Функция      | Наименование расширения | -                    | Подключение расширения JavaScript скрипта, список доступных расширений приведен в таблице 9                |
|              | path                 | Значение     | -                       | -                    | Абсолютный путь к текущему расширению                                                                      |

Таблица 7 - Состояния передачи УП

| Состояние | Описание                                                                  |
|-----------|---------------------------------------------------------------------------|
| -1        | Неизвестное состояние                                                     |
| 0         | Передача УП                                                               |
| 1         | Переход в состояние приостановки передачи                                 |
| 2         | Приостановка передачи                                                     |
| 3         | Окончание передачи, все команды УП отправлены                             |
| 4         | Передача завершена, все команды УП обработаны контроллером ЧПУ            |
| 5         | Ручная смена инструмента                                                  |

Таблица 8 - Состояния контроллера ЧПУ

| Состояние | Описание                                                                  |
|-----------|---------------------------------------------------------------------------|
| -1        | Неизвестное состояние                                                     |
| 1         | Готовность к приему команд                                                |
| 2         | Тревога                                                                   |
| 3         | Работа                                                                    |
| 4         | Поиск домашнего положения                                                 |
| 5         | Переход в режим "Удерживание" завершен                                    |
| 6         | Переход в режим "Удерживание"                                             |
| 8         | Режим проверки УП                                                         |
| 9         | Дверь закрыта, готовность к возобновлению работы                          |
| 10        | Дверь открыта, ЧПУ остановлен                                             |
| 11        | Дверь открыта, производится приостановка или парковка                     |
| 12        | Дверь закрыта, производится возобновление работы или возврат из парковки  |
| 13        | Состояние перемещения                                                     |
| 14        | Режим сна                                                                 |

Таблица 9 - Расширения скрипта

| Наименование расширения | Описание                                                                                         |
|-------------------------|--------------------------------------------------------------------------------------------------|
| qt.core                 | Набор базовых объектов Qt                                                                        |
| qt.custom               | Набор дополнительных элементов управления пользовательского интерфейса, описание в таблице 10    |
| qt.gui                  | Набор объектов пользовательского интерфейса Qt                                                   |
| qt.multimedia           | Набор мультимедийных объектов Qt                                                                 |
| qt.network              | Набор объектов Qt поддержки сети                                                                 |
| qt.opengl               | Набор объектов Qt поддержки спецификации OpenGL                                                  |
| qt.printsupport         | Набор объектов Qt поддержки печати                                                               |
| qt.sql                  | Набор объектов Qt поддержки баз данных                                                           |
| qt.uitools              | Набор объектов Qt для динамического создания пользовательского интерфейса                        |
| qt.xml                  | Набор объектов Qt поддержки языка разметки "XML"                                                 |
| qt.widgets              | Набор элементов управления пользовательского интерфейса Qt                                       |

Таблица 10 - Дополнительные элементы управления пользовательского интерфейса

| Тип объекта      | Базовый тип | Назначение                                            | Свойство         | Тип свойства | Аргументы   | Возвращаемое значение | Описание                                                            |
|------------------|-------------|-------------------------------------------------------|------------------|--------------|-------------|-----------------------|---------------------------------------------------------------------|
| ColorPicker      | QWidget     | Выбор цвета                                           | colorInt         | Значение     | -           | -                     | 32-разрядный код цвета в формате AARRGGBB                           |
|                  |             |                                                       | colorSelected    | Сигнал       | Цвет        | -                     | Сигнал, генерируемый при выборе цвета пользователем                 |
| Slider           | QSlider     | Ползунок с представлением текущего значения параметра | currentValue     | Значение     | -           | -                     | Текущее значение параметра                                          |
| SliderBox        | QWidget     | Ползунок с полем ввода значения и флагом включения    | value            | Значение     | -           | -                     | Уставка параметра                                                   |
|                  |             |                                                       | currentValue     | Значение     | -           | -                     | Текущее значение параметра                                          |
|                  |             |                                                       | minimum          | Значение     | -           | -                     | Минимальное значение параметра                                      |
|                  |             |                                                       | maximum          | Значение     | -           | -                     | Максимальное значение параметра                                     |
|                  |             |                                                       | sliderPosition   | Значение     | -           | -                     | Позиция ползунка                                                    |
|                  |             |                                                       | ratio            | Значение     | -           | -                     | Отношение значения в поле ввода к положению ползунка                |
|                  |             |                                                       | title            | Значение     | -           | -                     | Наименование параметра                                              |
|                  |             |                                                       | suffix           | Значение     | -           | -                     | Единицы измерения параметра                                         |
|                  |             |                                                       | isCheckable      | Значение     | -           | -                     | Отображение флага включения                                         |
|                  |             |                                                       | isChecked        | Значение     | -           | -                     | Включение/выключение флага                                          |
|                  |             |                                                       | valueUserChanged | Сигнал       | -           | -                     | Сигнал, генерируемый при изменении значения параметра пользователем |
|                  |             |                                                       | valueChanged     | Сигнал       | -           | -                     | Сигнал, генерируемый при изменении значения параметра               |
|                  |             |                                                       | toggled          | Сигнал       | Состояние   | -                     | Сигнал, генерируемый при смене состояния флага включения параметра  |
|                  |             |                                                       | click            | Функция      | -           | -                     | Программное переключение флага                                      |
| StyledToolButton | QToolButton | Кнопка инструментальной панели                        | backgroundColor  | Значение     | -           | -                     | Цвет фона кнопки, тип QColor                                        |
|                  |             |                                                       | foregroundColor  | Значение     | -           | -                     | Цвет надписи на кнопке                                              |
|                  |             |                                                       | highlightColor   | Значение     | -           | -                     | Цвет подсветки границ кнопки                                        |

# 5.3 Файл перевода

Каждое расширение может иметь файл перевода надписей. Формат имени файла следующий:

<p class="center">translation_xx.qm,</p>
где xx - двухбуквенный код языка перевода.

Скомпилированные файлы перевода "\*.qm" создаются из текстовых "\*.ts" с помощью программы "Qt Linguist" или консольной команды "lrelease", входящих в пакет установки фреймворка "Qt".

Подробнее о создании файлов переводов читайте в документации по фреймворку "Qt": [Qt Linguist Manual](https://doc.qt.io/qt-5/qtlinguist-index.html).

# Приложение А. Настройки контроллера

Таблица 11 - Описание настроек контроллера GRBL версии 1.1

| Код | Описание                                                                                                 | Допустимые значения                                                             | Пример значения |
|-----|----------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------|-----------------|
| 0   | Длительность импульса "Step" управления шаговыми двигателями, микросекунды                               |                                                                                 | 10              |
| 1   | Таймаут выключения шаговых двигателей, миллисекунды                                                      |                                                                                 | 25              |
| 2   | Битовая маска инвертирования сигналов "Step"                                                             | Разряд 0 - ось X, 1 - Y, 2 - Z                                                  | 0               |
| 3   | Битовая маска инвертирования сигналов "Dir"                                                              | Разряд 0 - ось X, 1 - Y, 2 - Z                                                  | 0               |
| 4   | Флаг инвертирования сигнала "Enable"                                                                     | 0 - активный уровень низкий, 1 - высокий                                        | 0               |
| 5   | Флаг инвертирования сигналов концевых выключателей                                                       | 0 - активный уровень низкий, 1 - высокий                                        | 0               |
| 6   | Флаг инвертирования сигнала зонда                                                                        | 0 - активный уровень низкий, 1 - высокий                                        | 0               |
| 10  | Битовая маска вывода информации о состоянии контроллера                                                  | Разряд 0 - вывод рабочих координат, 1 - машинных, 2 - вывод информации о буфере | 3               |
| 11  | Значение параметра Junction deviation, миллиметры                                                        |                                                                                 | 0.01            |
| 12  | Допустимое отклонение при аппроксимации дуг отрезками, миллиметры                                        |                                                                                 | 0.002           |
| 13  | Флаг вывода координат и смещений в дюймах                                                                | 0 - миллиметры, 1 - дюймы                                                       | 0               |
| 20  | Флаг включения программных границ                                                                        | 0 - выключено, 1 - включено                                                     | 0               |
| 21  | Флаг включения аппаратных границ                                                                         | 0 - выключено, 1 - включено                                                     | 0               |
| 22  | Флаг включения функции поиска домашнего положения                                                        | 0 - выключено, 1 - включено                                                     | 0               |
| 23  | Битовая маска инвертирования направления движения при поиске домашнего положения                         | Разряд 0 - ось X, 1 - Y, 2 - Z                                                  | 0               |
| 24  | Скорость поиска домашнего положения, миллиметры в секунду                                                |                                                                                 | 25              |
| 25  | Начальная скорость поиска домашнего положения, миллиметры в секунду                                      |                                                                                 | 250             |
| 26  | Время фильтра дребезга контактов концевых выключателей, миллисекунды                                     |                                                                                 | 250             |
| 27  | Расстояние отхода от концевых выключателей по завершению поиска домашнего положения, миллиметры          |                                                                                 | 1               |
| 30  | Максимальная скорость вращения шпинделя, обороты в секунду                                               |                                                                                 | 10000           |
| 31  | Минимальная скорость вращения шпинделя, обороты в секунду                                                |                                                                                 | 0               |
| 32  | Флаг включения режима "Лазер", движение без остановки при обработке кода "S"                             | 0 - выключено, 1 - включено                                                     | 0               |
| 100 | Количество шагов на один миллиметр по оси X                                                              |                                                                                 | 200             |
| 101 | Количество шагов на один миллиметр по оси Y                                                              |                                                                                 | 200             |
| 102 | Количество шагов на один миллиметр по оси Z                                                              |                                                                                 | 200             |
| 110 | Максимально допустимая скорость подачи по оси X, миллиметры в секунду                                    |                                                                                 | 2000            |
| 111 | Максимально допустимая скорость подачи по оси Y, миллиметры в секунду                                    |                                                                                 | 2000            |
| 112 | Максимально допустимая скорость подачи по оси Z, миллиметры в секунду                                    |                                                                                 | 2000            |
| 120 | Ускорение по оси X, миллиметры в секунду за секунду                                                      |                                                                                 | 200             |
| 121 | Ускорение по оси Y, миллиметры в секунду за секунду                                                      |                                                                                 | 200             |
| 122 | Ускорение по оси Z, миллиметры в секунду за секунду                                                      |                                                                                 | 200             |
| 130 | Максимально допустимое перемещение по оси X от домашнего положения (используется программными границами) |                                                                                 | 200             |
| 131 | Максимально допустимое перемещение по оси Y от домашнего положения                                       |                                                                                 | 200             |
| 132 | Максимально допустимое перемещение по оси Z от домашнего положения                                       |                                                                                 | 200             |

# Приложение Б. Ошибки контроллера

Таблица 12 - Описание ошибок контроллера

| Код ошибки | Название                                | Описание                                                                                                             |
|------------|------------------------------------------|----------------------------------------------------------------------------------------------------------------------|
| 1          | Ожидалось слово G-кода                   | Grbl ожидал корректную команду (например, G1, M3 и т.д.), но не нашёл её. Часто из-за пустой или повреждённой строки |
| 2          | Неверный формат числа                    | Число в команде имело неверный или некорректный формат                                                               |
| 3          | Недопустимая команда                     | Строка содержит неизвестную или неподдерживаемую команду                                                             |
| 4          | Отрицательное значение                   | Использовано отрицательное значение в месте, где это запрещено (например, подача или скорость шпинделя)              |
| 5          | Поиск домашнего положения не включен     | Был запрошен поиск домашнего положения ($H), но он отключен в настройках                                             |
| 6          | Нарушено минимальное время импульса шага | Импульс шага был выдан быстрее, чем позволяет настроенное минимальное время ($0)                                     |
| 7          | Ошибка чтения EEPROM                     | Grbl не смог прочитать настройки из EEPROM. Возможны проблемы с оборудованием                                        |
| 8          | Устройство не в режиме простоя           | Команда требует простоя, но в данный момент выполняется движение или другая операция                                 |
| 9          | Блокировка G-кода                        | Команда G-кода заблокирована из-за текущего состояния машины. Часто после сброса или аварии                          |
| 10         | Поиск домашнего положения не выполнен    | Станок требует определения домашнего положения перед выполнением команды                                             |
| 11         | Переполнение строки                      | Строка G-кода слишком длинная для внутреннего буфера Grbl                                                            |
| 12         | Слишком высокая частота шагов            | Grbl не может генерировать импульсы шагов достаточно быстро для заданного движения                                   |
| 13         | Открыта дверь безопасности               | Команда заблокирована, так как открыта дверь безопасности                                                            |
| 14         | Переполнение строки информации о версии  | Строка информации о версии превышает допустимую длину                                                                |
| 15         | Настройка отключена                      | Команда зависит от настройки (например, калибровки или soft limits), которая отключена                               |
| 16         | Отрицательное значение в настройках      | Значение настройки установлено отрицательным, что недопустимо                                                        |
| 17         | Неверная команда ручного перемещения     | Команда ручного перемещения имеет неверный формат или не поддерживается                                              |
| 20         | Неподдерживаемая команда                 | Команда не поддерживается парсером G-кода Grbl                                                                       |
| 21         | Конфликт модальных групп                 | Использованы две конфликтующие команды из одной модальной группы (например, два режима движения)                     |
| 22         | Не задана подача                         | Команда движения выполнена без указания подачи                                                                       |
| 23         | Конфликт осей в команде                  | Неправильное использование двух осей, например, в дугах или ручном перемещении                                       |
| 24         | Неверная целевая позиция                | Целевая позиция некорректна — например, дуга не может быть построена                                                 |
| 25         | Неверный радиус дуги                     | Команда дуги содержит радиус, который геометрически некорректен                                                      |
| 26         | Неверное слово G-кода                    | Слово использовано в неправильном контексте или запрещено для текущей команды                                        |
| 27         | Неверный номер строки                  | Номер строки использован некорректно или превышает допустимые пределы                                                |
| 28         | Повторяющееся слово значения            | Одно и то же слово G-кода использовано более одного раза в строке                                                    |
| 29         | Ошибка системы координат G59.x          | Использована система координат G59.1, G59.2 или G59.3, которая не поддерживается                                     |
| 30         | G53 с использованием смещения           | Команда G53 не может использоваться вместе с смещениями G54–G59                                                      |
| 31         | Неверное вещественное значение          | Значение с плавающей точкой некорректно (например, NaN или слишком много знаков после запятой)                       |
| 32         | Отсутствует ось в команде дуги           | В команде дуги отсутствует необходимое слово оси                                                                     |
| 33         | Ошибка формата дуги                      | Команда дуги содержит неверные или противоречивые данные (например, отсутствуют радиус и смещение)                   |
| 34         | Отсутствует ось в команде движения       | Команда движения выполнена без указания оси для перемещения                                                          |
| 35         | G2/G3 запрещены                          | Дуговые движения (G2/G3) запрещены в текущем состоянии, например при ручном перемещении                              |
| 36         | Лишние слова                             | Обнаружены лишние слова G-кода, не относящиеся к текущей команде                                                     |

# Приложение В. Таблица G-код команд

Таблица 13 - Краткая информация по G-код командам
    
| Команда   | Описание                                                                                                      | Пример                 |
|-----------|---------------------------------------------------------------------------------------------------------------|------------------------|
| G0        | Ускоренное перемещение                                                                                        | G0 X10 Y20 Z30         |
| G1        | Линейная интерполяция                                                                                         | G1 X0 Y0 Z0 F100       |
| G2        | Круговая интерполяция по часовой стрелке                                                                      | G2 X10 Y0 R5 F100      |
| G3        | Круговая интерполяция против часовой стрелки                                                                  | G3 X10 Y0 R5 F100      |
| G4        | Задержка выполнения УП, P - время задержки в секундах                                                         | G4 P0.5                |
| G10       | Задание смещений системы координат                                                                            | G10 L2 X10, G10 L20 X0 |
| G17       | Выбор плоскости X-Y круговой интерполяции                                                                     | G17                    |
| G18       | Выбор плоскости Z-X круговой интерполяции                                                                     | G18                    |
| G19       | Выбор плоскости Y-Z круговой интерполяции                                                                     | G19                    |
| G20       | Включение дюймовой системы измерения                                                                          | G20                    |
| G21       | Включение метрической системы измерения                                                                       | G21                    |
| G28       | Возврат в исходную позицию                                                                                    | G28 G91 X0 Y0 Z0       |
| G28.1     | Задание текущей позиции как исходной                                                                          | G28.1                  |
| G30       | Возврат в позицию смены инструмента                                                                           | G30 G91 Z0             |
| G30.1     | Задание текущей позиции как позиции смены инструмента                                                         | G30.1                  |
| G38.2     | Зондирование в направлении заготовки, ошибка при отсутствии контакта при перемещении на заданную дистанцию    | G38.2 G91 X10 F10      |
| G38.3     | Зондирование в направлении заготовки                                                                          | G38.3 G91 X10 F10      |
| G38.4     | Зондирование в направлении от заготовки, ошибка при сохранении контакта при перемещении на заданную дистанцию | G38.4 G91 X-10 F10     |
| G38.5     | Зондирование в направлении от заготовки                                                                       | G38.4 G91 X-10 F10     |
| G40       | Отмена компенсации радиуса инструмента                                                                        | G40                    |
| G43.1     | Компенсация длины инструмента                                                                                 | G43.1 Z0.5             |
| G49       | Отмена компенсации длины инструмента                                                                          | G49                    |
| G53       | Использовать систему координат станка (машинные координаты)                                                   | G53 G90 G0 X0 Y0       |
| G54...G59 | Выбор системы координат                                                                                       | G55                    |
| G61       | Включение режима точного останова                                                                             | G1 G61 X10 F100        |
| G80       | Отмена циклов                                                                                                 | G80                    |
| G90       | Использовать абсолютные координаты                                                                            | G1 G90 X10 Y10 Z0      |
| G91       | Использовать относительные координаты                                                                         | G1 G91 X10             |
| G91.1     | Использовать относительные координаты I, J, K задания круговой интерполяции                                   | G91.1                  |
| G92       | Задать смещения рабочих координат                                                                             | G92 X0 Y0              |
| G92.1     | Сброс смещения рабочих координат                                                                              | G92.1                  |
| G93       | Включение задания подачи в обратных единицах времени (1/F минут)                                              | G93                    |
| G94       | Включение задания подачи в миллиметрах в минуту                                                               | G94                    |
| M0        | Приостановка выполнения УП                                                                                    | M0                     |
| M1        | Условная приостановка выполнения УП                                                                           | M1                     |
| M2        | Завершение УП                                                                                                 | M2                     |
| M3        | Включение вращения шпинделя в направлении часовой стрелки                                                     | M3                     |
| M4        | Включение вращения шпинделя в направлении против часовой стрелки                                              | M4                     |
| M5        | Выключение шпинделя                                                                                           | M5                     |
| M7        | Включение воздушного охлаждения                                                                               | M7                     |
| M8        | Включение водяного охлаждения                                                                                 | M8                     |
| M9        | Выключение охлаждения                                                                                         | M9                     |
| M30       | Завершение УП с перемоткой в начало                                                                           | M30                    |